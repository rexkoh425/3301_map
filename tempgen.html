<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SGA Scheme Eligibility Checker</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">

<style>
:root {
  --clr-bg:#f2f7ff;
  --clr-primary:#006d77;
  --clr-secondary:#83c5be;
  --clr-accent:#edf6f9;
}
*{box-sizing:border-box;margin:0;padding:0;font-family:'Poppins',sans-serif}
body{
  background:var(--clr-bg);
  min-height:100vh;
  display:flex;align-items:center;justify-content:center;
  padding:2rem;
}
.card{
  width:100%;max-width:700px;
  background:#fff;border-radius:16px;overflow:hidden;
  box-shadow:0 4px 22px rgba(0,0,0,.1);
}
/* header */
.header{
  background:linear-gradient(135deg,var(--clr-primary),var(--clr-secondary));
  color:#fff;padding:1.3rem 1.75rem;
  display:flex;justify-content:space-between;align-items:center;gap:1rem;
}
.header h1{font-size:1.5rem;font-weight:600}
.lang-select{
  padding:.45rem .7rem;border:none;border-radius:6px;
  font-size:.85rem;cursor:pointer;color:var(--clr-primary);
}
/* content */
.content{padding:2rem 1.75rem}
.row{
  display:flex;align-items:center;gap:.8rem;margin-bottom:1.25rem;
}
.row span{flex:0 0 60%;font-weight:500}
.row select{flex:0 0 110px}
label{display:flex;align-items:center;gap:.4rem;font-weight:500;margin-bottom:.25rem}

/* icon buttons */
.voice-btn,.mic-btn{
  border:none;border-radius:50%;width:26px;height:26px;
  display:flex;align-items:center;justify-content:center;
  font-size:.8rem;color:#fff;cursor:pointer;
}
.voice-btn{background:var(--clr-secondary)}
.mic-btn {background:#2196f3}
.icon-pack{display:flex;gap:.35rem}

input,select{
  width:100%;padding:.7rem 1rem;border:1px solid #ccc;border-radius:8px;
  font-size:.9rem;
}

/* responsive */
@media(max-width:480px){
  .row{flex-direction:column;align-items:flex-start}
  .row span{flex:none;width:100%;margin-bottom:.25rem}
  .row select{flex:none;width:100%}
}

/* primary button */
button.primary{
  width:100%;padding:.9rem;border:none;border-radius:8px;
  background:var(--clr-primary);color:#fff;font-weight:600;
  cursor:pointer;transition:background .3s;
}
button.primary:hover{background:#004f55}

/* results */
.result-box{
  margin-top:1.5rem;padding:1.25rem;border-radius:10px;
  background:var(--clr-accent);color:var(--clr-primary);display:none;
}
.result-box h2{
  font-size:1.15rem;margin-bottom:.6rem;display:flex;align-items:center;gap:.4rem;
}
.scheme-search{
  width:100%;padding:.6rem 1rem;border:1px solid #aaa;border-radius:8px;
  margin-bottom:1rem;font-size:.85rem;
}
.scheme-list{list-style:none;margin-left:.2rem;padding-left:0}
.scheme-item{margin-bottom:.4rem}
.criteria{font-size:.85rem;color:#555;margin-left:1rem}
</style>
</head>
<body>

<div class="card">
  <div class="header">
    <h1>Eligibility Checker</h1>
    <select id="voiceLang" class="lang-select">
      <option value="en">English</option><option value="zh">Mandarin</option>
      <option value="ms">Malay</option><option value="ta">Tamil</option>
      <option value="hokkien">Hokkien</option><option value="cantonese">Cantonese</option>
    </select>
  </div>

  <div class="content">
    <!-- citizen row -->
    <div class="row">
      <span>Senior is a Singapore Citizen</span>
      <select id="citizen"><option value="yes">Yes</option><option value="no" selected>No</option></select>
      <div class="icon-pack">
        <button class="voice-btn" onclick="playText('Senior is a Singapore Citizen')">ðŸ”Š</button>
        <button class="mic-btn"   onclick="startVoiceInput('citizen')">ðŸŽ¤</button>
      </div>
    </div>

    <!-- comcare -->
    <div class="row">
      <span>Currently receiving ComCare assistance</span>
      <select id="comcare"><option value="yes">Yes</option><option value="no" selected>No</option></select>
      <div class="icon-pack">
        <button class="voice-btn" onclick="playText('Currently receiving ComCare assistance')">ðŸ”Š</button>
        <button class="mic-btn"   onclick="startVoiceInput('comcare')">ðŸŽ¤</button>
      </div>
    </div>

    <!-- disability -->
    <div class="row">
      <span>Has severe disability (needs help with daily living)</span>
      <select id="disability"><option value="yes">Yes</option><option value="no" selected>No</option></select>
      <div class="icon-pack">
        <button class="voice-btn" onclick="playText('Has severe disability')">ðŸ”Š</button>
        <button class="mic-btn"   onclick="startVoiceInput('disability')">ðŸŽ¤</button>
      </div>
    </div>

    <!-- subsidies -->
    <div class="row">
      <span>Already receiving CHAS / GST Voucher</span>
      <select id="subsidies"><option value="yes">Yes</option><option value="no" selected>No</option></select>
      <div class="icon-pack">
        <button class="voice-btn" onclick="playText('Already receiving CHAS or GST Voucher')">ðŸ”Š</button>
        <button class="mic-btn"   onclick="startVoiceInput('subsidies')">ðŸŽ¤</button>
      </div>
    </div>

    <!-- Age input -->
    <label>Age
      <div class="icon-pack">
        <button class="voice-btn" onclick="playText('Age')">ðŸ”Š</button>
        <button class="mic-btn"   onclick="startVoiceInput('age')">ðŸŽ¤</button>
      </div>
    </label>
    <input type="number" id="age" placeholder="Enter age">

    <!-- Income input -->
    <label>Monthly Household Income per Person
      <div class="icon-pack">
        <button class="voice-btn" onclick="playText('Monthly household income per person')">ðŸ”Š</button>
        <button class="mic-btn"   onclick="startVoiceInput('income')">ðŸŽ¤</button>
      </div>
    </label>
    <input type="number" id="income" placeholder="Enter amount">

    <!-- Housing type -->
    <label>Housing Type (HDB)
      <button class="voice-btn" onclick="playText('Housing type')">ðŸ”Š</button>
    </label>
    <select id="housing">
      <option value="1-room">1â€‘room</option><option value="2-room">2â€‘room</option>
      <option value="3-room">3â€‘room</option><option value="4-room">4â€‘room</option>
      <option value="5-room">5â€‘room / Exec</option><option value="private">Private Property</option>
    </select>

    <!-- CPF -->
    <label>CPF Contribution at 55
      <div class="icon-pack">
        <button class="voice-btn" onclick="playText('CPF contribution at fifty five')">ðŸ”Š</button>
        <button class="mic-btn"   onclick="startVoiceInput('cpf')">ðŸŽ¤</button>
      </div>
    </label>
    <input type="number" id="cpf" placeholder="Enter CPF total">

    <!-- Generation -->
    <label>Pioneer / Merdeka Generation
      <button class="voice-btn" onclick="playText('Pioneer or Merdeka Generation')">ðŸ”Š</button>
    </label>
    <select id="generation">
      <option value="none">None</option><option value="pioneer">Pioneer Generation</option><option value="merdeka">Merdeka Generation</option>
    </select>

    <!-- Employment -->
    <label>Employment Status
      <button class="voice-btn" onclick="playText('Employment status')">ðŸ”Š</button>
    </label>
    <select id="employment">
      <option value="employed">Employed</option><option value="retired">Retired</option><option value="unemployed">Unemployed</option>
    </select>

    <!-- action -->
    <button class="primary" onclick="checkEligibility()">Check Eligibility</button>

    <div id="result" class="result-box"></div>
  </div>
</div>

<script>
/* ----- placeholder TTS ----- */
const langSelect=document.getElementById('voiceLang');
function playText(t){alert(`Voice (${langSelect.value}): ${t}`);}

/* ----- voice input helper ----- */
function startVoiceInput(targetId){
  const SR = window.SpeechRecognition || window.webkitSpeechRecognition;
  if(!SR){alert('Voice input not supported in this browser');return;}
  const recog = new SR();
  recog.lang = 'en-SG';
  recog.interimResults = false;
  recog.start();

  const field = document.getElementById(targetId);
  field.style.outline='2px solid #2196f3';

  recog.onresult = e=>{
    const spoken = e.results[0][0].transcript.trim();
    let val = spoken;

    /* simple numeric cleanup */
    if(field.type==='number'){
      const num = parseFloat(spoken.replace(/[^0-9.]/g,''));
      val = isNaN(num)?'':num;
    }
    /* yes/no mapping for dropdowns */
    if(field.tagName==='SELECT'){
      val = /yes|yeah|yep/i.test(spoken)?'yes':
            /no|nah|nope/i.test(spoken)?'no':field.value;
    }
    field.value = val;
    field.style.outline='';
  };
  recog.onerror = ()=>{field.style.outline='';};
}

/* ----- eligibility logic (unchanged) ----- */
function add(map,scheme,msg){(map[scheme]=map[scheme]||[]).push(msg);}

function checkEligibility(){
  const citizen   = document.getElementById('citizen').value==='yes';
  const age       = +document.getElementById('age').value||0;
  const income    = +document.getElementById('income').value||0;
  const housing   = document.getElementById('housing').value;
  const comcare   = document.getElementById('comcare').value==='yes';
  const cpf55     = +document.getElementById('cpf').value||0;
  const generation= document.getElementById('generation').value;
  const employment= document.getElementById('employment').value;
  const disability= document.getElementById('disability').value==='yes';

  const eligible=[], reasons={};

  /* Silver Support */
  {
    const s='Silver Support Scheme';
    if(!citizen)                   add(reasons,s,'Must be Singapore citizen');
    if(age<65)                     add(reasons,s,`Age â‰¥ 65 (you entered ${age})`);
    if(income>2300)                add(reasons,s,`Income â‰¤ $2,300 (yours $${income})`);
    if(cpf55>140000)               add(reasons,s,`CPF at 55 â‰¤ $140,000 (yours $${cpf55})`);
    if(['5-room','private'].includes(housing))
                                   add(reasons,s,'Housing cannot be 5â€‘room/Exec or private');
    if(!reasons[s])                eligible.push(s);
  }

  /* Pioneer / Merdeka */
  if(generation==='pioneer'){
    citizen?eligible.push('Pioneer Generation Benefits'):
             add(reasons,'Pioneer Generation','Must be Singapore citizen');
  }
  if(generation==='merdeka'){
    citizen?eligible.push('Merdeka Generation Benefits'):
             add(reasons,'Merdeka Generation','Must be Singapore citizen');
  }

  /* CHAS */
  {
    const s='CHAS';
    if(!citizen) add(reasons,s,'Must be citizen');
    else{
      if(income<=1600||['1-room','2-room'].includes(housing)) eligible.push('CHAS Blue Card');
      else if(income<=2100)                                   eligible.push('CHAS Orange Card');
      else add(reasons,s,`Income too high: â‰¤$2,100 Orange / â‰¤$1,600 Blue (yours $${income})`);
    }
  }

  /* GST Voucher */
  {
    const s='GST Voucher';
    if(!citizen) add(reasons,s,'Must be citizen');
    else{
      if(income<=2800 && housing!=='private') eligible.push('GST Voucher (Cash & MediSave)');
      else{
        if(income>2800) add(reasons,s,`Income must be â‰¤$2,800 (yours $${income})`);
        if(housing==='private') add(reasons,s,'Property must be HDB (not private)');
      }
    }
  }

  /* Workfare */
  {
    const s='Workfare Income Supplement';
    if(!citizen) add(reasons,s,'Must be citizen');
    if(employment!=='employed') add(reasons,s,'Must be currently employed');
    if(age<35)  add(reasons,s,`Age must be â‰¥35 (you entered ${age})`);
    if(income>2500) add(reasons,s,`Income â‰¤ $2,500 (yours $${income})`);
    if(!reasons[s]) eligible.push(s);
  }

  /* Home Caregiving Grant */
  {
    const s='Home Caregiving Grant';
    if(!disability) add(reasons,s,'Requires severe disability');
    if(age<30) add(reasons,s,`Age must be â‰¥30 (you entered ${age})`);
    if(!reasons[s]) eligible.push(s);
  }

  /* ComCare */
  comcare?eligible.push('ComCare (already receiving)'):
           add(reasons,'ComCare','Not currently receiving assistance');

  renderResults(eligible,reasons);
}

function renderResults(eligible,reasonMap){
  const box=document.getElementById('result');
  box.innerHTML=''; box.style.display='block';

  if(eligible.length){
    box.innerHTML+=`
      <h2>Eligible Schemes <button class=\"voice-btn\" onclick=\"playText('Eligible schemes')\">ðŸ”Š</button></h2>
      <input type=\"text\" id=\"schemeSearch\" class=\"scheme-search\" placeholder=\"Search scheme...\" oninput=\"filterSchemes()\">
      <ul id=\"eligibleList\" class=\"scheme-list\">
        ${eligible.map(s=>`
          <li class=\"scheme-item\" data-name=\"${s.toLowerCase()}\">
            <span>${s}</span>
            <button class=\"voice-btn\" onclick=\"playText('${s}')\">ðŸ”Š</button>
          </li>`).join('')}
      </ul>`;
  }

  const entries=Object.entries(reasonMap);
  if(entries.length){
    box.innerHTML+=`
      <h2>Not Eligible <button class=\"voice-btn\" onclick=\"playText('Schemes you may not be eligible for')\">ðŸ”Š</button></h2>
      <ul class=\"scheme-list\">
        ${entries.map(([scheme,details])=>`
          <li class=\"scheme-item\">
            <span>${scheme}</span>
            ${details.map(d=>`<div class=\"criteria\">â€¢ ${d}</div>`).join('')}
            <button class=\"voice-btn\" onclick=\"playText('${scheme}. ${details.join('. ')}')\">ðŸ”Š</button>
          </li>`).join('')}
      </ul>`;
  }
}

function filterSchemes(){
  const q=document.getElementById('schemeSearch').value.toLowerCase();
  document.querySelectorAll('#eligibleList .scheme-item').forEach(it=>{
    it.style.display=it.dataset.name.includes(q)?'':'none';
  });
}
</script>
</body>
</html>
